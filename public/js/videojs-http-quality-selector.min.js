/*! @name videojs-http-quality-selector @version 1.2.1 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsHttpQualitySelector=t(e.videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);function n(e,t,o){return e(o={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&o.path)}},o.exports),o.exports}var r=n((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0})),l=n((function(e){function t(o,n){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(o,n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),i=n((function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0})),u=o.default.getComponent("MenuItem"),a=o.default.getComponent("Component"),s=function(e){function t(t,o){return o.selectable=!0,o.multiSelectable=!1,e.call(this,t,o)||this}i(t,e);var o=t.prototype;return o.handleClick=function(){var t=this.options_;e.prototype.handleClick.call(this);for(var o=this.player().qualityLevels(),n=o.length,r=0;r<n;r++)t.index===n||t.index===r?o[r].enabled=!0:o[r].enabled=!1},o.update=function(){var e=this.player().qualityLevels().selectedIndex;this.selected(this.options_.index===e)},t}(u);a.registerComponent("SourceMenuItem",s);var p=o.default.getComponent("MenuButton"),d=function(e){function t(t,n){var l;l=e.call(this,t,n)||this,p.apply(r(l),arguments);var i=l.player().qualityLevels(),u=i.length;if(n&&n.default)if("low"===n.default)for(var a=0;a<u;a++)i[a].enabled=0===a;else if("high"===n.default)for(var s=0;s<u;s++)i[s].enabled=s===u-1;return i.on(["change","addqualitylevel"],o.default.bind(r(l),l.update)),l}i(t,e);var n=t.prototype;return n.createEl=function(){return o.default.dom.createEl("div",{className:"vjs-http-quality-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},n.buildCSSClass=function(){return p.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},n.update=function(){return p.prototype.update.call(this)},n.createItems=function(){for(var e=[],t=this.player().qualityLevels(),o=[],n=t.length,r=0;r<n;r++){var l=n-(r+1),i=l===t.selectedIndex,u=""+l,a=l;t[l].height?(u=t[l].height+"p",a=parseInt(t[l].height,10)):t[l].bitrate&&(u=Math.floor(t[l].bitrate/1e3)+" kbps",a=parseInt(t[l].bitrate,10)),o.indexOf(u)>=0||(o.push(u),e.push(new s(this.player_,{label:u,index:l,selected:i,sortVal:a})))}return n>1&&e.push(new s(this.player_,{label:"Auto",index:n,selected:!1,sortVal:99999})),e.sort((function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0})),e},t}(p),c={},f=o.default.registerPlugin||o.default.plugin,h=function(e){var t=this;this.ready((function(){!function(e,t){if(e.addClass("vjs-http-quality-selector"),"Html5"!==e.techName_)return!1;e.on(["loadedmetadata"],(function(t){if("undefined"!==e.customHttpQualityeSelectorInitialized&&!0!==e.customHttpQualityeSelectorInitialized){e.customHttpQualityeSelectorInitialized=!0;var o=e.controlBar,n=o.getChild("fullscreenToggle").el();n?o.el().insertBefore(o.addChild("SourceMenuButton").el(),n):o.el().appendChild(o.addChild("SourceMenuButton").el())}}))}(t,o.default.mergeOptions(c,e))})),o.default.registerComponent("SourceMenuButton",d),o.default.registerComponent("SourceMenuItem",s)};return f("httpQualitySelector",h),h.VERSION="1.2.1",h}));

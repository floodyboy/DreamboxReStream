!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/document"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/document","global/window"],t):e.videojsContextmenuUi=t(e.videojs,e.document,e.window)}(this,(function(e,t,n){"use strict";function o(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;var i=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.handleClick=function(t){var o=this;e.prototype.handleClick.call(this),this.options_.listener(),n.setTimeout((function(){o.player().contextmenuUI.menu.dispose()}),1)},t}(e.getComponent("MenuItem")),r=e.getComponent("Menu"),u=e.dom||e,s=function(t){function r(o,r){var u;return(u=t.call(this,o,r)||this).dispose=e.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(u),u.dispose),r.content.forEach((function(t){var r=function(){};"function"==typeof t.listener?r=t.listener:"string"==typeof t.href&&(r=function(){return n.open(t.href)}),u.addItem(new i(o,{label:t.label,listener:e.bind(o,r)}))})),u}return o(r,t),r.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return u.addClass(e,"vjs-contextmenu-ui-menu"),e.style.left=this.options_.position.left+"px",e.style.top=this.options_.position.top+"px",e},r}(r);var c="5.2.0";function l(e){return e.hasOwnProperty("contextmenuUI")&&e.contextmenuUI.hasOwnProperty("menu")&&e.contextmenuUI.menu.el()}function a(e){var t=e.tagName.toLowerCase();return"input"===t||"textarea"===t}function p(o){var i=this;if(l(this))this.contextmenuUI.menu.dispose();else if(!this.contextmenuUI.options_.excludeElements(o.target)){var r=function(e,t){return{left:Math.round(t.width*e.x),top:Math.round(t.height-t.height*e.y)}}(function(e,o){var i={},r=function(e){var o;if(e.getBoundingClientRect&&e.parentNode&&(o=e.getBoundingClientRect()),!o)return{left:0,top:0};var i=t.documentElement,r=t.body,u=i.clientLeft||r.clientLeft||0,s=n.pageXOffset||r.scrollLeft,c=o.left+s-u,l=i.clientTop||r.clientTop||0,a=n.pageYOffset||r.scrollTop,p=o.top+a-l;return{left:Math.round(c),top:Math.round(p)}}(e),u=e.offsetWidth,s=e.offsetHeight,c=r.top,l=r.left,a=o.pageY,p=o.pageX;return o.changedTouches&&(p=o.changedTouches[0].pageX,a=o.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(c-a+s)/s)),i.x=Math.max(0,Math.min(1,(p-l)/u)),i}(this.el(),o),this.el().getBoundingClientRect()),u=e.browser.IS_FIREFOX?t.documentElement:t;o.preventDefault();var c=this.contextmenuUI.menu=new s(this,{content:this.contextmenuUI.content,position:r});this.contextmenuUI.closeMenu=function(){e.log.warn("player.contextmenuUI.closeMenu() is deprecated, please use player.contextmenuUI.menu.dispose() instead!"),c.dispose()},c.on("dispose",(function(){e.off(u,["click","tap"],c.dispose),i.removeChild(c),delete i.contextmenuUI.menu})),this.addChild(c);var a=c.el_.getBoundingClientRect(),p=t.body.getBoundingClientRect();(this.contextmenuUI.keepInside||a.right>p.width||a.bottom>p.height)&&(c.el_.style.left=Math.floor(Math.min(r.left,this.player_.currentWidth()-c.currentWidth()))+"px",c.el_.style.top=Math.floor(Math.min(r.top,this.player_.currentHeight()-c.currentHeight()))+"px"),e.on(u,["click","tap"],c.dispose)}}function d(t){var n=this,o={keepInside:!0,excludeElements:a};if(t=e.mergeOptions(o,t),!Array.isArray(t.content))throw new Error('"content" required');l(this)&&(this.contextmenuUI.menu.dispose(),this.off("contextmenu",this.contextmenuUI.onContextMenu),delete this.contextmenuUI);var i=this.contextmenuUI=function(){d.apply(this,arguments)};i.onContextMenu=e.bind(this,p),i.content=t.content,i.keepInside=t.keepInside,i.options_=t,i.VERSION=c,this.on("contextmenu",i.onContextMenu),this.ready((function(){return n.addClass("vjs-contextmenu-ui")}))}return e.registerPlugin("contextmenuUI",d),d.VERSION=c,d}));

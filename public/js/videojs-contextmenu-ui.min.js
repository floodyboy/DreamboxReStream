!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsContextmenuUi=t(e.videojs)}(this,(function(e){"use strict";var t=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(e);const n=t.default.getComponent("MenuItem");class o extends n{handleClick(e){super.handleClick(),this.options_.listener(),window.setTimeout((()=>{this.player().contextmenuUI.menu.dispose()}),1)}}const i=t.default.getComponent("Menu"),s=t.default.dom||t.default;class u extends i{constructor(e,n){super(e,n),this.dispose=t.default.bind(this,this.dispose),n.content.forEach((n=>{let i=function(){};"function"==typeof n.listener?i=n.listener:"string"==typeof n.href&&(i=()=>window.open(n.href)),this.addItem(new o(e,{label:n.label,listener:t.default.bind(e,i)}))}))}createEl(){const e=super.createEl();return s.addClass(e,"vjs-contextmenu-ui-menu"),e.style.left=this.options_.position.left+"px",e.style.top=this.options_.position.top+"px",e}}var c="6.0.0";function d(e){return e.hasOwnProperty("contextmenuUI")&&e.contextmenuUI.hasOwnProperty("menu")&&e.contextmenuUI.menu.el()}function l(e){const t=e.tagName.toLowerCase();return"input"===t||"textarea"===t}function r(e){if(d(this))return void this.contextmenuUI.menu.dispose();if(this.contextmenuUI.options_.excludeElements(e.target))return;const n=function(e,t){return{left:Math.round(t.width*e.x),top:Math.round(t.height-t.height*e.y)}}(function(e,t){const n={},o=function(e){let t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};const n=document.documentElement,o=document.body,i=n.clientLeft||o.clientLeft||0,s=window.pageXOffset||o.scrollLeft,u=t.left+s-i,c=n.clientTop||o.clientTop||0,d=window.pageYOffset||o.scrollTop,l=t.top+d-c;return{left:Math.round(u),top:Math.round(l)}}(e),i=e.offsetWidth,s=e.offsetHeight,u=o.top,c=o.left;let d=t.pageY,l=t.pageX;return t.changedTouches&&(l=t.changedTouches[0].pageX,d=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(u-d+s)/s)),n.x=Math.max(0,Math.min(1,(l-c)/i)),n}(this.el(),e),this.el().getBoundingClientRect()),o=t.default.browser.IS_FIREFOX?document.documentElement:document;e.preventDefault();const i=this.contextmenuUI.menu=new u(this,{content:this.contextmenuUI.content,position:n});this.contextmenuUI.closeMenu=()=>{t.default.log.warn("player.contextmenuUI.closeMenu() is deprecated, please use player.contextmenuUI.menu.dispose() instead!"),i.dispose()},i.on("dispose",(()=>{t.default.off(o,["click","tap"],i.dispose),this.removeChild(i),delete this.contextmenuUI.menu})),this.addChild(i);const s=i.el_.getBoundingClientRect(),c=document.body.getBoundingClientRect();(this.contextmenuUI.keepInside||s.right>c.width||s.bottom>c.height)&&(i.el_.style.left=Math.floor(Math.min(n.left,this.player_.currentWidth()-i.currentWidth()))+"px",i.el_.style.top=Math.floor(Math.min(n.top,this.player_.currentHeight()-i.currentHeight()))+"px"),t.default.on(o,["click","tap"],i.dispose)}function a(e){const n={keepInside:!0,excludeElements:l};if(e=t.default.mergeOptions(n,e),!Array.isArray(e.content))throw new Error('"content" required');d(this)&&(this.contextmenuUI.menu.dispose(),this.off("contextmenu",this.contextmenuUI.onContextMenu),delete this.contextmenuUI);const o=this.contextmenuUI=function(){a.apply(this,arguments)};o.onContextMenu=t.default.bind(this,r),o.content=e.content,o.keepInside=e.keepInside,o.options_=e,o.VERSION=c,this.on("contextmenu",o.onContextMenu),this.ready((()=>this.addClass("vjs-contextmenu-ui")))}return t.default.registerPlugin("contextmenuUI",a),a.VERSION=c,a}));
